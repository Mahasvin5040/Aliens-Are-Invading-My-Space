<!DOCTYPE html>


<html>
    <head>
        <title>Game or smthn idk</title>
    </head>

    <body style="background-color: rgb(128, 128, 128);">>

        <canvas id="myCanvas" style="border:2px solid #000000;">
        <img id = "imag" src="mrpenis.jpg" style="display:none;">

    </body>


    <script>

        var canvas = document.getElementById("myCanvas");
        var c = canvas.getContext("2d");

        var timeStep = 1.0 / 60.0;
        const img = document.getElementById("imag");

        canvas.width = window.innerWidth - 50.0;
        canvas.height = window.innerHeight - 50.0;

        function getRandomInt(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function draw(){
            c.clearRect(0, 0, canvas.width, canvas.height);

            for(var i = 0; i < numOfBalls; i++){
                obj = balls[i];
                c.fillStyle = obj.color;

                /*
                c.beginPath();
                c.rect(obj.pos.x, obj.pos.y, obj.size, obj.size);
                c.closePath();
                c.fill();
                */
                c.drawImage(img, obj.pos.x, obj.pos.y, obj.size, obj.size);
            }
        }

        //updates the position of the ball
        function calculate(ball){
            ball.pos.x += ball.vel.x * timeStep;
            ball.pos.y += ball.vel.y * timeStep;
            var UBX = canvas.width - ball.size;
            var LBX = 0;

            var UBY = canvas.height - ball.size;
            var LBY = 0;

            if(ball.pos.x > UBX){
                ball.pos.x = UBX;
                ball.vel.x *= -1.0;
            }

            if(ball.pos.x < LBX){
                ball.pos.x = LBX;
                ball.vel.x *= -1.0;
            }

            if(ball.pos.y > UBY){
                ball.pos.y = UBY;
                ball.vel.y *= -1.0;
            }

            if(ball.pos.y < LBY){
                ball.pos.y = LBY;
                ball.vel.y *= -1.0;
            }
        }

        function collision(){
            for(var i = 0; i < numOfBalls -1; i++){
                for(var j = i+1; j < numOfBalls; j++){
                    let ball1 = balls[i];
                    let ball2 = balls[j];

                    let distx1 = ball1.pos.x - ball2.pos.x;
                    let disty1 = ball1.pos.y - ball2.pos.y;

                    if(Math.abs(distx1) < ballSize && Math.abs(disty1) < ballSize){
                        if(Math.abs(distx1) < ballSize && Math.abs(distx1) > Math.abs(disty1)){
                            //console.log("x");
                            ball1.vel.x *= -1;
                            ball2.vel.x *= -1;

                            if(distx1 < 0){
                                let cent = ball1.pos.x + Math.abs(distx1/2.0);
                                //console.log(distx1, cent );
                                ball1.pos.x = cent - ballSize/2.0;
                                ball2.pos.x = cent + ballSize/2.0;
                            }else if(distx1 > 0){
                                let cent = ball2.pos.x + Math.abs(distx1/2.0);
                                //console.log(distx1, cent );
                                ball1.pos.x = cent + ballSize/2.0;
                                ball2.pos.x = cent - ballSize/2.0;
                            }
                        }
                        else if(Math.abs(disty1) < ballSize && Math.abs(distx1) < Math.abs(disty1)){
                            //console.log("y");
                            ball1.vel.y *= -1;
                            ball2.vel.y *= -1;

                            if(disty1 < 0){
                                let cent = ball1.pos.y + Math.abs(disty1/2.0);
                                //console.log(disty1, cent );
                                ball1.pos.y = cent - ballSize/2.0;
                                ball2.pos.y = cent + ballSize/2.0;
                            }else if(disty1 > 0){
                                let cent = ball2.pos.y + Math.abs(disty1/2.0);
                                //console.log(disty1, cent );
                                ball1.pos.y = cent + ballSize/2.0;
                                ball2.pos.y = cent - ballSize/2.0;
                            }
                        }
                    }
                }
            }
        }

        function update(){
            for(var i = 0; i < numOfBalls; i++){
                calculate(balls[i]);
            }
            collision();
            draw();
            requestAnimationFrame(update);
        }

        const numOfBalls = 100; // Change this value to change the # of balls
        const ballSize = 40;
        const speed = 1000;
        const balls = []; // array for balls
        //Creates balls and populates array
        for(var i = 0; i < numOfBalls; i++){

            //Creates 3 new colors

            var r = Math.floor(Math.random() * 206 + 50);
            var g = Math.floor(Math.random() * 206 + 50);
            var b = Math.floor(Math.random() * 206 + 50);

            //sets a random color to 0 for more vibrant colors
            var rgb = getRandomInt(1, 4);
            if(rgb == 1){
                r = 0;
            }else if(rgb == 2){
                g = 0;
            }else{
                b = 0;
            }
            const randomColor = `rgb(${r}, ${g}, ${b})`;

            //creates the object
            const object = {
                color : randomColor,
                size : ballSize, // change this value to change the size of the balls
                pos : {x : getRandomInt(0, canvas.width), y : getRandomInt(0, canvas.height)},
                vel : {x : getRandomInt(-speed, speed), y : getRandomInt(-speed, speed)},
            }
            balls.push(object);
        }

        update();


    </script>

</html>
